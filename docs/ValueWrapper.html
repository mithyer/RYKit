<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å±æ€§åŒ…è£…å™¨æ¨¡å— - ADKit</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/swift.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; position: relative; }
        .back-btn { position: absolute; top: 20px; left: 20px; background: rgba(255, 255, 255, 0.2); border: 2px solid white; color: white; padding: 10px 20px; border-radius: 25px; cursor: pointer; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; transition: all 0.3s ease; font-size: 14px; }
        .back-btn:hover { background: white; color: #667eea; transform: translateX(-5px); }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; display: flex; align-items: center; gap: 15px; }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .content { padding: 40px; }
        .section { margin-bottom: 50px; }
        .section-title { font-size: 2em; color: #333; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 3px solid #667eea; }
        .subsection { margin-bottom: 30px; }
        .subsection-title { font-size: 1.5em; color: #667eea; margin-bottom: 15px; }
        .description { line-height: 1.8; color: #555; margin-bottom: 20px; font-size: 1.05em; }
        .feature-list { list-style: none; margin: 20px 0; }
        .feature-list li { padding: 12px 0 12px 35px; position: relative; color: #555; line-height: 1.6; }
        .feature-list li:before { content: "âœ“"; position: absolute; left: 10px; color: #667eea; font-weight: bold; font-size: 1.2em; }
        .code-block { margin: 20px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); }
        .code-header { background: #21252b; color: #abb2bf; padding: 12px 20px; font-size: 0.9em; display: flex; justify-content: space-between; align-items: center; }
        .code-lang { font-weight: bold; color: #61afef; }
        pre { margin: 0 !important; border-radius: 0 !important; }
        pre code { display: block; padding: 20px !important; font-size: 14px; line-height: 1.6; font-family: 'Monaco', 'Menlo', 'Consolas', monospace; }
        .api-table { width: 100%; border-collapse: collapse; margin: 20px 0; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); border-radius: 10px; overflow: hidden; }
        .api-table th { background: #667eea; color: white; padding: 15px; text-align: left; font-weight: 600; }
        .api-table td { padding: 15px; border-bottom: 1px solid #eee; }
        .api-table tr:last-child td { border-bottom: none; }
        .api-table tr:nth-child(even) { background: #f8f9fa; }
        .highlight-box { background: #f0f7ff; border-left: 4px solid #667eea; padding: 20px; margin: 20px 0; border-radius: 5px; }
        .highlight-box-title { font-weight: bold; color: #667eea; margin-bottom: 10px; font-size: 1.1em; }
        .tag { display: inline-block; background: #667eea; color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.85em; margin-right: 10px; margin-bottom: 10px; }
        .warning-box { background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin: 20px 0; border-radius: 5px; }
        @media (max-width: 768px) { .header h1 { font-size: 1.8em; } .content { padding: 20px; } .back-btn { position: static; margin-bottom: 20px; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="back-btn"><span>â†</span><span>è¿”å›ç´¢å¼•</span></a>
            <h1><span>ğŸ</span><span>å±æ€§åŒ…è£…å™¨æ¨¡å—</span></h1>
            <p>æä¾›å¤šç§ Property Wrapper ç®€åŒ– Codable ä½¿ç”¨</p>
        </div>

        <div class="content">
            <div class="section">
                <h2 class="section-title">æ¨¡å—æ¦‚è¿°</h2>
                <div class="description">
                    å±æ€§åŒ…è£…å™¨æ¨¡å—æä¾›äº†ä¸‰ä¸ªå¼ºå¤§çš„ Property Wrapperï¼Œç”¨äºç®€åŒ– Swift Codable çš„ä½¿ç”¨ã€‚å®ƒä»¬è§£å†³äº† JSON è§£æä¸­å¸¸è§çš„é—®é¢˜ï¼šå­—æ®µç¼ºå¤±ã€ç±»å‹ä¸åŒ¹é…ã€éœ€è¦å¿½ç•¥æŸäº›å­—æ®µç­‰ã€‚
                </div>
                
                <div class="highlight-box">
                    <div class="highlight-box-title">ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿</div>
                    <ul class="feature-list" style="margin: 10px 0;">
                        <li><strong>@DefaultValue</strong> - å­—æ®µç¼ºå¤±æ—¶æä¾›é»˜è®¤å€¼ï¼Œé¿å…è§£ç å¤±è´¥</li>
                        <li><strong>@PreferValue</strong> - å°è¯•ç±»å‹è½¬æ¢ï¼Œç±»å‹ä¸åŒ¹é…æ—¶è¿”å› nil</li>
                        <li><strong>@IgnoreValue</strong> - è·³è¿‡ç¼–ç /è§£ç ï¼Œç”¨äºä¸´æ—¶å±æ€§</li>
                        <li>è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼šString â†” Int â†” Double â†” Bool â†” Decimal</li>
                        <li>å‡å°‘æ ·æ¿ä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡</li>
                    </ul>
                </div>

                <div style="margin-top: 20px;">
                    <span class="tag">iOS 13.0+</span>
                    <span class="tag">macOS 10.15+</span>
                    <span class="tag">tvOS 13.0+</span>
                    <span class="tag">Swift 5.0+</span>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">å®‰è£…æ–¹å¼</h2>
                <div class="code-block">
                    <div class="code-header"><span class="code-lang">Ruby (Podfile)</span></div>
                    <pre><code class="language-ruby">pod 'ADKit/ValueWrapper'</code></pre>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">@DefaultValue</h2>
                
                <div class="description">
                    <strong>@DefaultValue</strong> åœ¨å­—æ®µç¼ºå¤±æˆ–æ— æ³•è§£ç æ—¶æä¾›é»˜è®¤å€¼ï¼Œé¿å…æ•´ä¸ªæ¨¡å‹è§£ç å¤±è´¥ã€‚åŒæ—¶æ”¯æŒè‡ªåŠ¨ç±»å‹è½¬æ¢ã€‚
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ“ åŸºç¡€ä½¿ç”¨</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Swift</span><span>ä½¿ç”¨é»˜è®¤å€¼</span></div>
                        <pre><code class="language-swift">import ADKit

struct User: Codable {
    @Default.StringEmpty var name: String          // é»˜è®¤ ""
    @Default.IntZero var age: Int                  // é»˜è®¤ 0
    @Default.BoolFalse var isVIP: Bool             // é»˜è®¤ false
    @Default.DoubleZero var score: Double          // é»˜è®¤ 0.0
    @Default.DecimalZero var balance: Decimal      // é»˜è®¤ 0
    @Default.ArrayEmpty var tags: [String]         // é»˜è®¤ []
}

// JSON ç¤ºä¾‹
let json1 = """
{
    "name": "å¼ ä¸‰",
    "age": 25,
    "isVIP": true,
    "score": 95.5,
    "balance": "1000.50",
    "tags": ["VIP", "Active"]
}
"""

let json2 = """
{
    "name": "æå››"
    // å…¶ä»–å­—æ®µç¼ºå¤±ï¼Œä¼šä½¿ç”¨é»˜è®¤å€¼
}
"""

// è§£ç æˆåŠŸï¼Œç¼ºå¤±çš„å­—æ®µä½¿ç”¨é»˜è®¤å€¼
let user1 = try JSONDecoder().decode(User.self, from: json1.data(using: .utf8)!)
// name: "å¼ ä¸‰", age: 25, isVIP: true, score: 95.5, balance: 1000.50, tags: ["VIP", "Active"]

let user2 = try JSONDecoder().decode(User.self, from: json2.data(using: .utf8)!)
// name: "æå››", age: 0, isVIP: false, score: 0.0, balance: 0, tags: []</code></pre>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ“‹ å¯ç”¨çš„é»˜è®¤å€¼ç±»å‹</h3>
                    <table class="api-table">
                        <thead>
                            <tr>
                                <th style="width: 35%;">ç±»å‹</th>
                                <th>é»˜è®¤å€¼</th>
                                <th>è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>@Default.BoolFalse</code></td>
                                <td><code>false</code></td>
                                <td>å¸ƒå°”å€¼é»˜è®¤ false</td>
                            </tr>
                            <tr>
                                <td><code>@Default.BoolTrue</code></td>
                                <td><code>true</code></td>
                                <td>å¸ƒå°”å€¼é»˜è®¤ true</td>
                            </tr>
                            <tr>
                                <td><code>@Default.IntZero</code></td>
                                <td><code>0</code></td>
                                <td>æ•´æ•°é»˜è®¤ 0</td>
                            </tr>
                            <tr>
                                <td><code>@Default.DoubleZero</code></td>
                                <td><code>0.0</code></td>
                                <td>æµ®ç‚¹æ•°é»˜è®¤ 0.0</td>
                            </tr>
                            <tr>
                                <td><code>@Default.DecimalZero</code></td>
                                <td><code>Decimal.zero</code></td>
                                <td>ç²¾ç¡®å°æ•°é»˜è®¤ 0</td>
                            </tr>
                            <tr>
                                <td><code>@Default.StringEmpty</code></td>
                                <td><code>""</code></td>
                                <td>å­—ç¬¦ä¸²é»˜è®¤ç©ºä¸²</td>
                            </tr>
                            <tr>
                                <td><code>@Default.ArrayEmpty</code></td>
                                <td><code>[]</code></td>
                                <td>æ•°ç»„é»˜è®¤ç©ºæ•°ç»„</td>
                            </tr>
                            <tr>
                                <td><code>@Default.DicEmpty</code></td>
                                <td><code>[:]</code></td>
                                <td>å­—å…¸é»˜è®¤ç©ºå­—å…¸</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ”„ è‡ªåŠ¨ç±»å‹è½¬æ¢</h3>
                    <div class="description">
                        @DefaultValue æ”¯æŒè‡ªåŠ¨ç±»å‹è½¬æ¢ï¼Œå³ä½¿ JSON ä¸­çš„ç±»å‹ä¸åŒ¹é…ä¹Ÿèƒ½æ­£ç¡®è§£æã€‚
                    </div>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Swift</span><span>ç±»å‹è‡ªåŠ¨è½¬æ¢</span></div>
                        <pre><code class="language-swift">struct Product: Codable {
    @Default.StringEmpty var id: String
    @Default.IntZero var stock: Int
    @Default.DoubleZero var price: Double
    @Default.BoolFalse var available: Bool
}

// JSON ä¸­ç±»å‹ä¸åŒ¹é…ï¼Œä½†ä»èƒ½æ­£ç¡®è§£æ
let json = """
{
    "id": 12345,              // æ•°å­—ä¼šè½¬æ¢ä¸ºå­—ç¬¦ä¸² "12345"
    "stock": "100",           // å­—ç¬¦ä¸²ä¼šè½¬æ¢ä¸ºæ•°å­— 100
    "price": "99.99",         // å­—ç¬¦ä¸²ä¼šè½¬æ¢ä¸ºæµ®ç‚¹æ•° 99.99
    "available": 1            // æ•°å­— 1 ä¼šè½¬æ¢ä¸º true
}
"""

let product = try JSONDecoder().decode(Product.self, from: json.data(using: .utf8)!)
// id: "12345", stock: 100, price: 99.99, available: true

// æ”¯æŒçš„è½¬æ¢è§„åˆ™ï¼š
// String â†” Int: "123" â†’ 123, 123 â†’ "123"
// String â†” Double: "99.99" â†’ 99.99, 99.99 â†’ "99.99"
// String â†” Bool: "true"/"yes"/"1" â†’ true, true â†’ "true"
// Int â†” Bool: 0 â†’ false, 1 â†’ true
// Int â†” Double: 100 â†’ 100.0, 100.0 â†’ 100</code></pre>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ“ å®é™…åº”ç”¨åœºæ™¯</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Swift</span><span>API å“åº”æ¨¡å‹</span></div>
                        <pre><code class="language-swift">// åœºæ™¯ï¼šåç«¯ API å¯èƒ½è¿”å›ä¸å®Œæ•´çš„æ•°æ®
struct APIResponse: Codable {
    @Default.StringEmpty var message: String
    @Default.IntZero var code: Int
    @Default.BoolTrue var success: Bool
    @Default.ArrayEmpty var items: [Item]
    
    struct Item: Codable {
        @Default.StringEmpty var id: String
        @Default.StringEmpty var name: String
        @Default.DoubleZero var price: Double
        @Default.IntZero var quantity: Int
    }
}

// å³ä½¿åç«¯è¿”å›æ•°æ®ä¸å®Œæ•´ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´æ•´ä¸ªè§£æå¤±è´¥
let partialJSON = """
{
    "code": 200
    // message, success, items å­—æ®µç¼ºå¤±
}
"""

let response = try JSONDecoder().decode(APIResponse.self, from: partialJSON.data(using: .utf8)!)
// message: "", code: 200, success: true, items: []</code></pre>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">@PreferValue</h2>
                
                <div class="description">
                    <strong>@PreferValue</strong> ç”¨äºå¯é€‰ç±»å‹ï¼Œå°è¯•ç±»å‹è½¬æ¢ï¼Œè½¬æ¢å¤±è´¥åˆ™ä¸º nilã€‚ä¸ @DefaultValue çš„åŒºåˆ«æ˜¯å®ƒä¸ä¼šåœ¨å¤±è´¥æ—¶ä½¿ç”¨é»˜è®¤å€¼ï¼Œè€Œæ˜¯è¿”å› nilã€‚
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ“ åŸºç¡€ä½¿ç”¨</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Swift</span><span>å¯é€‰å€¼è½¬æ¢</span></div>
                        <pre><code class="language-swift">struct Product: Codable {
    @PreferValue var id: String?
    @PreferValue var count: Int?
    @PreferValue var price: Double?
    @PreferValue var isAvailable: Bool?
}

// ç¤ºä¾‹1ï¼šç±»å‹åŒ¹é…
let json1 = """
{
    "id": "P001",
    "count": 100,
    "price": 99.99,
    "isAvailable": true
}
"""
let p1 = try JSONDecoder().decode(Product.self, from: json1.data(using: .utf8)!)
// id: "P001", count: 100, price: 99.99, isAvailable: true

// ç¤ºä¾‹2ï¼šç±»å‹ä¸åŒ¹é…ä½†å¯ä»¥è½¬æ¢
let json2 = """
{
    "id": 123,              // Int â†’ String
    "count": "50",          // String â†’ Int
    "price": "29.99",       // String â†’ Double
    "isAvailable": 1        // Int â†’ Bool
}
"""
let p2 = try JSONDecoder().decode(Product.self, from: json2.data(using: .utf8)!)
// id: "123", count: 50, price: 29.99, isAvailable: true

// ç¤ºä¾‹3ï¼šæ— æ³•è½¬æ¢ï¼Œè¿”å› nil
let json3 = """
{
    "id": "P002",
    "count": "abc",         // æ— æ³•è½¬æ¢ä¸º Int
    "price": "invalid",     // æ— æ³•è½¬æ¢ä¸º Double
    "isAvailable": "maybe"  // æ— æ³•è½¬æ¢ä¸º Bool
}
"""
let p3 = try JSONDecoder().decode(Product.self, from: json3.data(using: .utf8)!)
// id: "P002", count: nil, price: nil, isAvailable: nil</code></pre>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ†š @DefaultValue vs @PreferValue</h3>
                    <table class="api-table">
                        <thead>
                            <tr>
                                <th style="width: 20%;">ç‰¹æ€§</th>
                                <th>@DefaultValue</th>
                                <th>@PreferValue</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ç±»å‹</td>
                                <td>éå¯é€‰ç±»å‹</td>
                                <td>å¯é€‰ç±»å‹</td>
                            </tr>
                            <tr>
                                <td>å­—æ®µç¼ºå¤±</td>
                                <td>ä½¿ç”¨é»˜è®¤å€¼</td>
                                <td>è¿”å› nil</td>
                            </tr>
                            <tr>
                                <td>ç±»å‹ä¸åŒ¹é…</td>
                                <td>å°è¯•è½¬æ¢ï¼Œå¤±è´¥ç”¨é»˜è®¤å€¼</td>
                                <td>å°è¯•è½¬æ¢ï¼Œå¤±è´¥è¿”å› nil</td>
                            </tr>
                            <tr>
                                <td>ä½¿ç”¨åœºæ™¯</td>
                                <td>å¿…é¡»æœ‰å€¼çš„å­—æ®µ</td>
                                <td>å¯èƒ½ä¸ºç©ºçš„å­—æ®µ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ“ ç»„åˆä½¿ç”¨</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Swift</span><span>æ··åˆä½¿ç”¨ä¸¤ç§åŒ…è£…å™¨</span></div>
                        <pre><code class="language-swift">struct User: Codable {
    // å¿…å¡«å­—æ®µï¼Œä½¿ç”¨ @DefaultValue
    @Default.StringEmpty var id: String
    @Default.StringEmpty var username: String
    @Default.IntZero var age: Int
    
    // é€‰å¡«å­—æ®µï¼Œä½¿ç”¨ @PreferValue
    @PreferValue var email: String?
    @PreferValue var phone: String?
    @PreferValue var score: Double?
    @PreferValue var vipLevel: Int?
}

let json = """
{
    "id": "U001",
    "username": "å¼ ä¸‰",
    "email": "zhangsan@example.com",
    "score": "95.5"
    // age, phone, vipLevel ç¼ºå¤±
}
"""

let user = try JSONDecoder().decode(User.self, from: json.data(using: .utf8)!)
// id: "U001"
// username: "å¼ ä¸‰"
// age: 0 (é»˜è®¤å€¼)
// email: "zhangsan@example.com"
// phone: nil
// score: 95.5 (ç±»å‹è½¬æ¢æˆåŠŸ)
// vipLevel: nil</code></pre>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">@IgnoreValue</h2>
                
                <div class="description">
                    <strong>@IgnoreValue</strong> æ ‡è®°çš„å±æ€§ä¸å‚ä¸ Codable çš„ç¼–ç å’Œè§£ç è¿‡ç¨‹ï¼Œé€‚ç”¨äºä¸´æ—¶è®¡ç®—å±æ€§æˆ–ä¸éœ€è¦æŒä¹…åŒ–çš„å­—æ®µã€‚
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ“ åŸºç¡€ä½¿ç”¨</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Swift</span><span>å¿½ç•¥å­—æ®µ</span></div>
                        <pre><code class="language-swift">struct Article: Codable {
    var id: String
    var title: String
    var content: String
    var publishDate: Date
    
    // ä¸´æ—¶çŠ¶æ€ï¼Œä¸éœ€è¦ç¼–ç /è§£ç 
    @IgnoreValue var isExpanded: Bool?
    @IgnoreValue var cachedHTML: String?
    @IgnoreValue var viewController: UIViewController?
}

let article = Article(
    id: "A001",
    title: "Swift æ•™ç¨‹",
    content: "...",
    publishDate: Date()
)

// ç¼–ç æ—¶ï¼Œ@IgnoreValue æ ‡è®°çš„å­—æ®µä¼šè¢«è·³è¿‡
let encoder = JSONEncoder()
let jsonData = try encoder.encode(article)
let jsonString = String(data: jsonData, encoding: .utf8)!
print(jsonString)
// è¾“å‡ºï¼š{"id":"A001","title":"Swift æ•™ç¨‹","content":"...","publishDate":...}
// isExpanded, cachedHTML, viewController ä¸åœ¨ JSON ä¸­

// è§£ç æ—¶ï¼Œ@IgnoreValue å­—æ®µæ€»æ˜¯ nil
let decoded = try JSONDecoder().decode(Article.self, from: jsonData)
// decoded.isExpanded == nil
// decoded.cachedHTML == nil
// decoded.viewController == nil</code></pre>
                    </div>
                </div>

                <div class="subsection">
                    <h3 class="subsection-title">ğŸ“ ä½¿ç”¨åœºæ™¯</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Swift</span><span>å…¸å‹åº”ç”¨åœºæ™¯</span></div>
                        <pre><code class="language-swift">// åœºæ™¯1ï¼šUI çŠ¶æ€
struct ListItem: Codable {
    var id: String
    var name: String
    
    @IgnoreValue var isSelected: Bool?     // UI é€‰ä¸­çŠ¶æ€
    @IgnoreValue var isExpanded: Bool?     // UI å±•å¼€çŠ¶æ€
}

// åœºæ™¯2ï¼šç¼“å­˜æ•°æ®
struct User: Codable {
    var id: String
    var username: String
    var avatarURL: String
    
    @IgnoreValue var cachedAvatar: UIImage?    // ç¼“å­˜çš„å¤´åƒ
    @IgnoreValue var lastFetchTime: Date?      // æœ€åè·å–æ—¶é—´
}

// åœºæ™¯3ï¼šå¼•ç”¨ç±»å‹
struct ChatMessage: Codable {
    var id: String
    var content: String
    var senderId: String
    
    @IgnoreValue var senderInfo: User?         // ä¸éœ€è¦åºåˆ—åŒ–çš„å…³è”æ•°æ®
    @IgnoreValue var cell: UITableViewCell?    // UI ç»„ä»¶å¼•ç”¨
}

// åœºæ™¯4ï¼šè®¡ç®—å±æ€§çš„å­˜å‚¨
struct Product: Codable {
    var id: String
    var price: Double
    var discount: Double
    
    // æœ€ç»ˆä»·æ ¼å¯ä»¥è®¡ç®—ï¼Œä¸éœ€è¦å­˜å‚¨
    var finalPrice: Double {
        price * (1 - discount)
    }
    
    // ä½†å¦‚æœéœ€è¦ä¸´æ—¶ç¼“å­˜è®¡ç®—ç»“æœ
    @IgnoreValue var cachedFinalPrice: Double?
}</code></pre>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">ç±»å‹è½¬æ¢è§„åˆ™</h2>
                
                <div class="description">
                    @DefaultValue å’Œ @PreferValue æ”¯æŒä»¥ä¸‹ç±»å‹ä¹‹é—´çš„è‡ªåŠ¨è½¬æ¢ï¼š
                </div>

                <table class="api-table">
                    <thead>
                        <tr>
                            <th>ä»ç±»å‹</th>
                            <th>åˆ°ç±»å‹</th>
                            <th>è½¬æ¢è§„åˆ™</th>
                            <th>ç¤ºä¾‹</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>String</td>
                            <td>Int</td>
                            <td>è§£ææ•°å­—å­—ç¬¦ä¸²</td>
                            <td>"123" â†’ 123</td>
                        </tr>
                        <tr>
                            <td>String</td>
                            <td>Double</td>
                            <td>è§£æå°æ•°å­—ç¬¦ä¸²</td>
                            <td>"99.99" â†’ 99.99</td>
                        </tr>
                        <tr>
                            <td>String</td>
                            <td>Bool</td>
                            <td>"true","yes","1" â†’ true</td>
                            <td>"yes" â†’ true</td>
                        </tr>
                        <tr>
                            <td>Int</td>
                            <td>String</td>
                            <td>è½¬ä¸ºå­—ç¬¦ä¸²</td>
                            <td>123 â†’ "123"</td>
                        </tr>
                        <tr>
                            <td>Int</td>
                            <td>Double</td>
                            <td>è½¬ä¸ºæµ®ç‚¹æ•°</td>
                            <td>100 â†’ 100.0</td>
                        </tr>
                        <tr>
                            <td>Int</td>
                            <td>Bool</td>
                            <td>0 â†’ false, 1 â†’ true</td>
                            <td>1 â†’ true</td>
                        </tr>
                        <tr>
                            <td>Double</td>
                            <td>Int</td>
                            <td>æˆªæ–­å°æ•°éƒ¨åˆ†</td>
                            <td>99.9 â†’ 99</td>
                        </tr>
                        <tr>
                            <td>Bool</td>
                            <td>Int</td>
                            <td>false â†’ 0, true â†’ 1</td>
                            <td>true â†’ 1</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="section">
                <h2 class="section-title">æœ€ä½³å®è·µ</h2>
                
                <div class="highlight-box">
                    <div class="highlight-box-title">ğŸ’¡ æ¨èåšæ³•</div>
                    <ul class="feature-list" style="margin: 10px 0;">
                        <li>å¯¹äºå¿…å¡«å­—æ®µä½¿ç”¨ @DefaultValueï¼Œå¯é€‰å­—æ®µä½¿ç”¨ @PreferValue</li>
                        <li>æ˜ç¡®å­—æ®µçš„ä¸šåŠ¡å«ä¹‰ï¼Œé€‰æ‹©åˆé€‚çš„é»˜è®¤å€¼</li>
                        <li>ä½¿ç”¨ @IgnoreValue å­˜å‚¨ UI çŠ¶æ€æˆ–ä¸´æ—¶æ•°æ®</li>
                        <li>åœ¨å›¢é˜Ÿä¸­ç»Ÿä¸€ä½¿ç”¨è¿™äº›åŒ…è£…å™¨ï¼Œå‡å°‘æ‰‹åŠ¨å¤„ç† JSON çš„ä»£ç </li>
                        <li>å¯¹äºé‡‘é¢ç­‰æ•æ„Ÿæ•°æ®ï¼Œä½¿ç”¨ Decimal è€Œä¸æ˜¯ Double</li>
                        <li>åœ¨å•å…ƒæµ‹è¯•ä¸­éªŒè¯è¾¹ç•Œæƒ…å†µï¼ˆå­—æ®µç¼ºå¤±ã€ç±»å‹ä¸åŒ¹é…ç­‰ï¼‰</li>
                    </ul>
                </div>

                <div class="warning-box">
                    <strong>âš ï¸ æ³¨æ„äº‹é¡¹</strong>
                    <ul class="feature-list" style="margin: 10px 0;">
                        <li>@DefaultValue åªèƒ½ç”¨äºéå¯é€‰ç±»å‹</li>
                        <li>@PreferValue åªèƒ½ç”¨äºå¯é€‰ç±»å‹</li>
                        <li>@IgnoreValue çš„å­—æ®µåœ¨è§£ç åæ€»æ˜¯ nil</li>
                        <li>ç±»å‹è½¬æ¢å¯èƒ½å¯¼è‡´ç²¾åº¦æŸå¤±ï¼ˆå¦‚ Double â†’ Intï¼‰</li>
                        <li>ç¡®ä¿é»˜è®¤å€¼ç¬¦åˆä¸šåŠ¡é€»è¾‘è¦æ±‚</li>
                    </ul>
                </div>

                <div class="code-block">
                    <div class="code-header"><span class="code-lang">Swift</span><span>å®Œæ•´ç¤ºä¾‹</span></div>
                    <pre><code class="language-swift">struct OrderItem: Codable {
    // å¿…å¡«å­—æ®µ
    @Default.StringEmpty var id: String
    @Default.StringEmpty var productId: String
    @Default.IntZero var quantity: Int
    @Default.DecimalZero var unitPrice: Decimal
    
    // å¯é€‰å­—æ®µ
    @PreferValue var discountPercent: Double?
    @PreferValue var note: String?
    
    // ä¸´æ—¶çŠ¶æ€
    @IgnoreValue var isSelected: Bool?
    @IgnoreValue var cachedSubtotal: Decimal?
    
    // è®¡ç®—å±æ€§
    var subtotal: Decimal {
        if let cached = cachedSubtotal {
            return cached
        }
        let value = Decimal(quantity) * unitPrice
        return value
    }
}

// å¯ä»¥å¤„ç†å„ç§æƒ…å†µçš„ JSON
let json1 = """
{ "id": "I001", "productId": "P001", "quantity": 2, "unitPrice": "99.50" }
"""

let json2 = """
{ "id": "I002", "productId": "P002", "quantity": "5", "unitPrice": 150 }
"""

let json3 = """
{ "id": "I003" }  // å¤§éƒ¨åˆ†å­—æ®µç¼ºå¤±
"""

// éƒ½å¯ä»¥æ­£ç¡®è§£ç 
let item1 = try JSONDecoder().decode(OrderItem.self, from: json1.data(using: .utf8)!)
let item2 = try JSONDecoder().decode(OrderItem.self, from: json2.data(using: .utf8)!)
let item3 = try JSONDecoder().decode(OrderItem.self, from: json3.data(using: .utf8)!)</code></pre>
                </div>
            </div>
        </div>
    </div>

    <script>hljs.highlightAll();</script>
</body>
</html>
